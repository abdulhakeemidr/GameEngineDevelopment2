\hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source}{}\doxysection{Multiplayer\+Game\+State.\+cpp}
\label{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source}\index{Week14/Week14-\/Demo1-\/Player2/Source/MultiplayerGameState.cpp@{Week14/Week14-\/Demo1-\/Player2/Source/MultiplayerGameState.cpp}}
\mbox{\hyperlink{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#pragma region step 9}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00002}00002 \textcolor{preprocessor}{\#include <MultiplayerGameState.hpp>}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00003}00003 \textcolor{preprocessor}{\#include <MusicPlayer.hpp>}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include <Utility.hpp>}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include <SFML/Graphics/RenderWindow.hpp>}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include <SFML/Network/IpAddress.hpp>}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00009}00009 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00010}00010 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00012}\mbox{\hyperlink{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_a9cae8d507c09cd1fbe2da7d1b6977e38}{00012}} \mbox{\hyperlink{classsf_1_1_ip_address}{sf::IpAddress}} \mbox{\hyperlink{_s_f_m_l-2_85_81_2_source_2_multiplayer_game_state_8cpp_a9cae8d507c09cd1fbe2da7d1b6977e38}{getAddressFromFile}}()}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00013}00013 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00014}00014     \{ \textcolor{comment}{// Try to open existing file (RAII block)}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00015}00015         std::ifstream inputFile(\textcolor{stringliteral}{"{}ip.txt"{}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00016}00016         std::string ipAddress;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00017}00017         \textcolor{keywordflow}{if} (inputFile >> ipAddress)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00018}00018             \textcolor{keywordflow}{return} ipAddress;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00019}00019     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00021}00021     \textcolor{comment}{// If open/read failed, create new file}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00022}00022     std::ofstream outputFile(\textcolor{stringliteral}{"{}ip.txt"{}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00023}00023     std::string localAddress = \textcolor{stringliteral}{"{}127.0.0.1"{}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00024}00024     outputFile << localAddress;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00025}00025     \textcolor{keywordflow}{return} localAddress;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00026}00026 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00028}00028 \mbox{\hyperlink{class_multiplayer_game_state_abdff9f279bb851861d1dbba9cf33d90b}{MultiplayerGameState::MultiplayerGameState}}(\mbox{\hyperlink{class_state_stack}{StateStack}}\& stack, Context context, \textcolor{keywordtype}{bool} isHost)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00029}00029     : \mbox{\hyperlink{class_state}{State}}(stack, context)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00030}00030     , mWorld(*context.window, *context.fonts, *context.sounds, true)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00031}00031     , mWindow(*context.window)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00032}00032     , mTextureHolder(*context.textures)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00033}00033     , mConnected(false)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00034}00034     , mGameServer(nullptr)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00035}00035     , mActiveState(true)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00036}00036     , mHasFocus(true)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00037}00037     , mHost(isHost)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00038}00038     , mGameStarted(false)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00039}00039     , mClientTimeout(\mbox{\hyperlink{namespacesf}{sf}}::\mbox{\hyperlink{classsf_1_1_time_ae36b9ef700f0ed0516abf0194ceb546b}{seconds}}(2.f))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00040}00040     , mTimeSinceLastPacket(\mbox{\hyperlink{namespacesf}{sf}}::\mbox{\hyperlink{classsf_1_1_time_ae36b9ef700f0ed0516abf0194ceb546b}{seconds}}(0.f))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00041}00041 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00042}00042     mBroadcastText.setFont(context.fonts-\/>get(\mbox{\hyperlink{namespace_fonts_a240717ec0dc75e98501af734a02c396da9e5a008b88415e37d30b922f06c8eabc}{Fonts::Main}}));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00043}00043     mBroadcastText.setPosition(1024.f / 2, 100.f);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00045}00045     mPlayerInvitationText.setFont(context.fonts-\/>get(\mbox{\hyperlink{namespace_fonts_a240717ec0dc75e98501af734a02c396da9e5a008b88415e37d30b922f06c8eabc}{Fonts::Main}}));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00046}00046     mPlayerInvitationText.setCharacterSize(20);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00047}00047     mPlayerInvitationText.setFillColor(\mbox{\hyperlink{classsf_1_1_color_abd9695b00da63b890ea40f74629237c0}{sf::Color::White}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00048}00048     mPlayerInvitationText.setString(\textcolor{stringliteral}{"{}Press Enter to spawn player 2"{}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00049}00049     mPlayerInvitationText.setPosition(1000 -\/ mPlayerInvitationText.getLocalBounds().width, 760 -\/ mPlayerInvitationText.getLocalBounds().height);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00051}00051     \textcolor{comment}{// We reuse this text for "{}Attempt to connect"{} and "{}Failed to connect"{} messages}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00052}00052     mFailedConnectionText.setFont(context.fonts-\/>get(\mbox{\hyperlink{namespace_fonts_a240717ec0dc75e98501af734a02c396da9e5a008b88415e37d30b922f06c8eabc}{Fonts::Main}}));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00053}00053     mFailedConnectionText.setString(\textcolor{stringliteral}{"{}Attempting to connect..."{}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00054}00054     mFailedConnectionText.setCharacterSize(35);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00055}00055     mFailedConnectionText.setFillColor(\mbox{\hyperlink{classsf_1_1_color_abd9695b00da63b890ea40f74629237c0}{sf::Color::White}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00056}00056     \mbox{\hyperlink{_week11_2_week11-_demo1-_game_over_2_include_2_utility_8hpp_add3ffea68d586813ee6765c3bc796d35}{centerOrigin}}(mFailedConnectionText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00057}00057     mFailedConnectionText.setPosition(mWindow.getSize().x / 2.f, mWindow.getSize().y / 2.f);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00059}00059     \textcolor{comment}{// Render a "{}establishing connection"{} frame for user feedback}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00060}00060     mWindow.clear(\mbox{\hyperlink{classsf_1_1_color_a25bf5208c8c7668f1a3836acbbb23986}{sf::Color::Black}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00061}00061     mWindow.draw(mFailedConnectionText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00062}00062     mWindow.display();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00063}00063     mFailedConnectionText.setString(\textcolor{stringliteral}{"{}Could not connect to the remote server!"{}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00064}00064     \mbox{\hyperlink{_week11_2_week11-_demo1-_game_over_2_include_2_utility_8hpp_add3ffea68d586813ee6765c3bc796d35}{centerOrigin}}(mFailedConnectionText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00066}00066     \mbox{\hyperlink{classsf_1_1_ip_address}{sf::IpAddress}} ip;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00067}00067     \textcolor{keywordflow}{if} (isHost)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00068}00068     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00069}00069         mGameServer.reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_game_server}{GameServer}}(\mbox{\hyperlink{classsf_1_1_vector2}{sf::Vector2f}}(mWindow.getSize())));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00070}00070         ip = \textcolor{stringliteral}{"{}127.0.0.1"{}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00071}00071     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00072}00072     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00073}00073     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00074}00074         ip = \mbox{\hyperlink{_s_f_m_l-2_85_81_2_source_2_multiplayer_game_state_8cpp_a9cae8d507c09cd1fbe2da7d1b6977e38}{getAddressFromFile}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00075}00075     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00077}00077     \textcolor{keywordflow}{if} (mSocket.connect(ip, \mbox{\hyperlink{_s_f_m_l-2_85_81_2include_2_network_protocol_8hpp_a46f6fa8990f0a21731b90db2d1e75e21}{ServerPort}}, sf::seconds(5.f)) == \mbox{\hyperlink{classsf_1_1_socket_a51bf0fd51057b98a10fbb866246176dca6b3d5ba897b6df8ebda86c823b30348a}{sf::TcpSocket::Done}})}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00078}00078         mConnected = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00079}00079     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00080}00080         mFailedConnectionClock.restart();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00082}00082     mSocket.setBlocking(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00083}00083 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00084}00084     \textcolor{comment}{// Play game theme}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00085}00085     context.music-\/>play(\mbox{\hyperlink{namespace_music_ad5e0c8c2e2e7bdcbffbb125051531b86ae4e89e8707f6839c7ad32e35a5881da7}{Music::MissionTheme}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00086}00086 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00088}00088 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_multiplayer_game_state_a629171643cccd9c8914b50971a9dc940}{MultiplayerGameState::draw}}()}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00089}00089 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00090}00090     \textcolor{keywordflow}{if} (mConnected)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00091}00091     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00092}00092         mWorld.\mbox{\hyperlink{class_world_ab51a17ccbb108616daacd0c34973dc8d}{draw}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00094}00094         \textcolor{comment}{// Broadcast messages in default view}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00095}00095         mWindow.\mbox{\hyperlink{classsf_1_1_render_target_a063db6dd0a14913504af30e50cb6d946}{setView}}(mWindow.\mbox{\hyperlink{classsf_1_1_render_target_a7741129e3ef7ab4f0a40024fca13480c}{getDefaultView}}());}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00097}00097         \textcolor{keywordflow}{if} (!mBroadcasts.empty())}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00098}00098             mWindow.\mbox{\hyperlink{classsf_1_1_render_target_a12417a3bcc245c41d957b29583556f39}{draw}}(mBroadcastText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00099}00099 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00100}00100         \textcolor{keywordflow}{if} (mLocalPlayerIdentifiers.size() < 2 \&\& mPlayerInvitationTime < sf::seconds(0.5f))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00101}00101             mWindow.\mbox{\hyperlink{classsf_1_1_render_target_a12417a3bcc245c41d957b29583556f39}{draw}}(mPlayerInvitationText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00102}00102     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00103}00103     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00104}00104     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00105}00105         mWindow.\mbox{\hyperlink{classsf_1_1_render_target_a12417a3bcc245c41d957b29583556f39}{draw}}(mFailedConnectionText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00106}00106     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00107}00107 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00109}00109 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_multiplayer_game_state_ae4f04690436f735755228e98c99f4b4f}{MultiplayerGameState::onActivate}}()}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00110}00110 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00111}00111     mActiveState = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00112}00112 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00113}00113 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00114}00114 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_multiplayer_game_state_afb40e8a952b1f6264e688b80fc894bde}{MultiplayerGameState::onDestroy}}()}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00115}00115 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00116}00116     \textcolor{keywordflow}{if} (!mHost \&\& mConnected)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00117}00117     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00118}00118         \textcolor{comment}{// Inform server this client is dying}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00119}00119         \mbox{\hyperlink{classsf_1_1_packet}{sf::Packet}} packet;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00120}00120         packet << static\_cast<sf::Int32>(\mbox{\hyperlink{namespace_client_a68298dc54679aba9954afeb49186f8f0a0875fd7848910bd45f98d72f5081a205}{Client::Quit}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00121}00121         mSocket.\mbox{\hyperlink{classsf_1_1_tcp_socket_affce26ab3bcc4f5b9269dad79db544c0}{send}}(packet);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00122}00122     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00123}00123 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00125}00125 \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_multiplayer_game_state_a5affe4cb62f5acadcdb9b81d1766ad6a}{MultiplayerGameState::update}}(\mbox{\hyperlink{classsf_1_1_time}{sf::Time}} dt)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00126}00126 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00127}00127     \textcolor{comment}{// Connected to server: Handle all the network logic}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00128}00128     \textcolor{keywordflow}{if} (mConnected)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00129}00129     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00130}00130         mWorld.\mbox{\hyperlink{class_world_ac7b3a3923c95b812ec2d00d97c8cd56e}{update}}(dt);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00132}00132         \textcolor{comment}{// Remove players whose aircrafts were destroyed}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00133}00133         \textcolor{keywordtype}{bool} foundLocalPlane = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00134}00134         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} itr = mPlayers.begin(); itr != mPlayers.end(); )}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00135}00135         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00136}00136             \textcolor{comment}{// Check if there are no more local planes for remote clients}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00137}00137             \textcolor{keywordflow}{if} (std::find(mLocalPlayerIdentifiers.begin(), mLocalPlayerIdentifiers.end(), itr-\/>first) != mLocalPlayerIdentifiers.end())}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00138}00138             \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00139}00139                 foundLocalPlane = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00140}00140             \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00141}00141 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00142}00142             \textcolor{keywordflow}{if} (!mWorld.\mbox{\hyperlink{class_world_a61c420ab669d97df70d7d2b69e3ca19c}{getAircraft}}(itr-\/>first))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00143}00143             \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00144}00144                 itr = mPlayers.erase(itr);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00146}00146                 \textcolor{comment}{// No more players left: Mission failed}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00147}00147                 \textcolor{keywordflow}{if} (mPlayers.empty())}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00148}00148                     \mbox{\hyperlink{class_state_a6763de833ceb9c23df45aff163a4a1cd}{requestStackPush}}(\mbox{\hyperlink{namespace_states_a571a0dc62822f97bb9511eb013d8e1c3a71dc473546eabb69b61986a34a7f104e}{States::GameOver}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00149}00149             \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00150}00150             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00151}00151             \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00152}00152                 ++itr;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00153}00153             \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00154}00154         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00156}00156         \textcolor{keywordflow}{if} (!foundLocalPlane \&\& mGameStarted)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00157}00157         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00158}00158             \mbox{\hyperlink{class_state_a6763de833ceb9c23df45aff163a4a1cd}{requestStackPush}}(\mbox{\hyperlink{namespace_states_a571a0dc62822f97bb9511eb013d8e1c3a71dc473546eabb69b61986a34a7f104e}{States::GameOver}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00159}00159         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00161}00161         \textcolor{comment}{// Only handle the realtime input if the window has focus and the game is unpaused}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00162}00162         \textcolor{keywordflow}{if} (mActiveState \&\& mHasFocus)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00163}00163         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00164}00164             \mbox{\hyperlink{class_command_queue}{CommandQueue}}\& commands = mWorld.\mbox{\hyperlink{class_world_af224b413f30c86ec99d042d0f4df56ee}{getCommandQueue}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00165}00165             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pair : mPlayers)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00166}00166                 pair.second-\/>handleRealtimeInput(commands);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00167}00167         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00169}00169         \textcolor{comment}{// Always handle the network input}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00170}00170         \mbox{\hyperlink{class_command_queue}{CommandQueue}}\& commands = mWorld.\mbox{\hyperlink{class_world_af224b413f30c86ec99d042d0f4df56ee}{getCommandQueue}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00171}00171         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pair : mPlayers)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00172}00172             pair.second-\/>handleRealtimeNetworkInput(commands);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00174}00174         \textcolor{comment}{// Handle messages from server that may have arrived}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00175}00175         \mbox{\hyperlink{classsf_1_1_packet}{sf::Packet}} packet;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00176}00176         \textcolor{keywordflow}{if} (mSocket.\mbox{\hyperlink{classsf_1_1_tcp_socket_a90ce50811ea61d4f00efc62bb99ae1af}{receive}}(packet) == \mbox{\hyperlink{classsf_1_1_socket_a51bf0fd51057b98a10fbb866246176dca6b3d5ba897b6df8ebda86c823b30348a}{sf::Socket::Done}})}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00177}00177         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00178}00178             mTimeSinceLastPacket = sf::seconds(0.f);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00179}00179             \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} packetType;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00180}00180             packet >> packetType;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00181}00181             handlePacket(packetType, packet);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00182}00182         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00183}00183         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00184}00184         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00185}00185             \textcolor{comment}{// Check for timeout with the server}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00186}00186             \textcolor{keywordflow}{if} (mTimeSinceLastPacket > mClientTimeout)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00187}00187             \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00188}00188                 mConnected = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00190}00190                 mFailedConnectionText.\mbox{\hyperlink{classsf_1_1_text_a7d3b3359f286fd9503d1ced25b7b6c33}{setString}}(\textcolor{stringliteral}{"{}Lost connection to server"{}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00191}00191                 \mbox{\hyperlink{_week11_2_week11-_demo1-_game_over_2_include_2_utility_8hpp_add3ffea68d586813ee6765c3bc796d35}{centerOrigin}}(mFailedConnectionText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00192}00192 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00193}00193                 mFailedConnectionClock.\mbox{\hyperlink{classsf_1_1_clock_a123e2627f2943e5ecaa1db0c7df3231b}{restart}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00194}00194             \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00195}00195         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00197}00197         updateBroadcastMessage(dt);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00198}00198 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00199}00199         \textcolor{comment}{// Time counter for blinking 2nd player text}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00200}00200         mPlayerInvitationTime += dt;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00201}00201         \textcolor{keywordflow}{if} (mPlayerInvitationTime > sf::seconds(1.f))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00202}00202             mPlayerInvitationTime = \mbox{\hyperlink{classsf_1_1_time_aa343e67f43a940e7b3b51aa10a495f2f}{sf::Time::Zero}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00204}00204         \textcolor{comment}{// Events occurring in the game}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00205}00205         \mbox{\hyperlink{struct_game_actions_1_1_action}{GameActions::Action}} gameAction;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00206}00206         \textcolor{keywordflow}{while} (mWorld.\mbox{\hyperlink{class_world_a3f51d78daaab42e9ea353f0ab31e51af}{pollGameAction}}(gameAction))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00207}00207         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00208}00208             \mbox{\hyperlink{classsf_1_1_packet}{sf::Packet}} packet;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00209}00209             packet << static\_cast<sf::Int32>(\mbox{\hyperlink{namespace_client_a68298dc54679aba9954afeb49186f8f0ad53486696653a4baa5f48b134f01caad}{Client::GameEvent}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00210}00210             packet << static\_cast<sf::Int32>(gameAction.\mbox{\hyperlink{struct_game_actions_1_1_action_ac4b04fe7c91e9f47d55665d7272b4622}{type}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00211}00211             packet << gameAction.\mbox{\hyperlink{struct_game_actions_1_1_action_ac6834c74b5e0b5db797e2226da4dc83f}{position}}.\mbox{\hyperlink{classsf_1_1_vector2_a1e6ad77fa155f3753bfb92699bd28141}{x}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00212}00212             packet << gameAction.\mbox{\hyperlink{struct_game_actions_1_1_action_ac6834c74b5e0b5db797e2226da4dc83f}{position}}.\mbox{\hyperlink{classsf_1_1_vector2_a420f2481b015f4eb929c75f2af564299}{y}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00213}00213 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00214}00214             mSocket.\mbox{\hyperlink{classsf_1_1_tcp_socket_affce26ab3bcc4f5b9269dad79db544c0}{send}}(packet);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00215}00215         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00216}00216 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00217}00217         \textcolor{comment}{// Regular position updates}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00218}00218         \textcolor{keywordflow}{if} (mTickClock.\mbox{\hyperlink{classsf_1_1_clock_abe889b42a65bcd8eefc16419645d08a7}{getElapsedTime}}() > sf::seconds(1.f / 20.f))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00219}00219         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00220}00220             \mbox{\hyperlink{classsf_1_1_packet}{sf::Packet}} positionUpdatePacket;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00221}00221             positionUpdatePacket << static\_cast<sf::Int32>(\mbox{\hyperlink{namespace_client_a68298dc54679aba9954afeb49186f8f0af1f1f7cef86c4058a0105657e764f72c}{Client::PositionUpdate}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00222}00222             positionUpdatePacket << static\_cast<sf::Int32>(mLocalPlayerIdentifiers.size());}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00223}00223 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00224}00224             \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} identifier : mLocalPlayerIdentifiers)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00225}00225             \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00226}00226                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_aircraft}{Aircraft}}* aircraft = mWorld.\mbox{\hyperlink{class_world_a61c420ab669d97df70d7d2b69e3ca19c}{getAircraft}}(identifier))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00227}00227                     positionUpdatePacket << identifier << aircraft-\/>getPosition().x << aircraft-\/>getPosition().y << \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}}\textcolor{keyword}{>}(aircraft-\/>getHitpoints()) << \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}}\textcolor{keyword}{>}(aircraft-\/>getMissileAmmo());}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00228}00228             \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00229}00229 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00230}00230             mSocket.\mbox{\hyperlink{classsf_1_1_tcp_socket_affce26ab3bcc4f5b9269dad79db544c0}{send}}(positionUpdatePacket);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00231}00231             mTickClock.\mbox{\hyperlink{classsf_1_1_clock_a123e2627f2943e5ecaa1db0c7df3231b}{restart}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00232}00232         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00233}00233 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00234}00234         mTimeSinceLastPacket += dt;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00235}00235     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00236}00236 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00237}00237     \textcolor{comment}{// Failed to connect and waited for more than 5 seconds: Back to menu}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00238}00238     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mFailedConnectionClock.\mbox{\hyperlink{classsf_1_1_clock_abe889b42a65bcd8eefc16419645d08a7}{getElapsedTime}}() >= sf::seconds(5.f))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00239}00239     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00240}00240         \mbox{\hyperlink{class_state_a4b602bed9bf0179ee5f6748fce340ae6}{requestStateClear}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00241}00241         \mbox{\hyperlink{class_state_a6763de833ceb9c23df45aff163a4a1cd}{requestStackPush}}(\mbox{\hyperlink{namespace_states_a571a0dc62822f97bb9511eb013d8e1c3aa06c751fdc170f36553c431e03501fe6}{States::Menu}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00242}00242     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00243}00243 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00244}00244     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00245}00245 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00246}00246 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00247}00247 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_multiplayer_game_state_aae8391f9b734eb396bc5340d131f4441}{MultiplayerGameState::disableAllRealtimeActions}}()}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00248}00248 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00249}00249     mActiveState = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00251}00251     \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} identifier : mLocalPlayerIdentifiers)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00252}00252         mPlayers[identifier]-\/>disableAllRealtimeActions();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00253}00253 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00254}00254 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00255}00255 \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_multiplayer_game_state_a27489fecf201c5dfd5f046f0e4f813b5}{MultiplayerGameState::handleEvent}}(\textcolor{keyword}{const} \mbox{\hyperlink{classsf_1_1_event}{sf::Event}}\& event)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00256}00256 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00257}00257     \textcolor{comment}{// Game input handling}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00258}00258     \mbox{\hyperlink{class_command_queue}{CommandQueue}}\& commands = mWorld.\mbox{\hyperlink{class_world_af224b413f30c86ec99d042d0f4df56ee}{getCommandQueue}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00259}00259 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00260}00260     \textcolor{comment}{// Forward event to all players}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00261}00261     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pair : mPlayers)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00262}00262         pair.second-\/>handleEvent(event, commands);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00264}00264     \textcolor{keywordflow}{if} (event.\mbox{\hyperlink{classsf_1_1_event_adf2f8044f713fd9d6019077b0d1ffe0a}{type}} == \mbox{\hyperlink{classsf_1_1_event_af41fa9ed45c02449030699f671331d4aaadc5747df45354b4d2c89558c3f0d1a4}{sf::Event::KeyPressed}})}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00265}00265     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00266}00266         \textcolor{comment}{// Enter pressed, add second player co-\/op (only if we are one player)}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00267}00267         \textcolor{keywordflow}{if} (event.\mbox{\hyperlink{classsf_1_1_event_a45b92fc6757ca7c193f06b302e424ab0}{key}}.\mbox{\hyperlink{structsf_1_1_event_1_1_key_event_a2879fdab8a68cb1c6ecc45730a2d0e61}{code}} == \mbox{\hyperlink{classsf_1_1_keyboard_acb4cacd7cc5802dec45724cf3314a142a45990e46db316fb01b760bce6b5fcf32}{sf::Keyboard::Return}} \&\& mLocalPlayerIdentifiers.size() == 1)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00268}00268         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00269}00269             \mbox{\hyperlink{classsf_1_1_packet}{sf::Packet}} packet;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00270}00270             packet << static\_cast<sf::Int32>(\mbox{\hyperlink{namespace_client_a68298dc54679aba9954afeb49186f8f0a81fcf6a64d26ded8d4e54e4df020f5b1}{Client::RequestCoopPartner}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00271}00271 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00272}00272             mSocket.\mbox{\hyperlink{classsf_1_1_tcp_socket_affce26ab3bcc4f5b9269dad79db544c0}{send}}(packet);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00273}00273         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00274}00274 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00275}00275         \textcolor{comment}{// Escape pressed, trigger the pause screen}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00276}00276         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (event.\mbox{\hyperlink{classsf_1_1_event_a45b92fc6757ca7c193f06b302e424ab0}{key}}.\mbox{\hyperlink{structsf_1_1_event_1_1_key_event_a2879fdab8a68cb1c6ecc45730a2d0e61}{code}} == \mbox{\hyperlink{classsf_1_1_keyboard_acb4cacd7cc5802dec45724cf3314a142a72019ff9ecb145a9d3910177a49c757a}{sf::Keyboard::Escape}})}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00277}00277         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00278}00278             \mbox{\hyperlink{class_multiplayer_game_state_aae8391f9b734eb396bc5340d131f4441}{disableAllRealtimeActions}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00279}00279             \mbox{\hyperlink{class_state_a6763de833ceb9c23df45aff163a4a1cd}{requestStackPush}}(\mbox{\hyperlink{namespace_states_a571a0dc62822f97bb9511eb013d8e1c3adea3c92a65089ff6920c31b485798799}{States::NetworkPause}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00280}00280         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00281}00281     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00282}00282     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (event.\mbox{\hyperlink{classsf_1_1_event_adf2f8044f713fd9d6019077b0d1ffe0a}{type}} == \mbox{\hyperlink{classsf_1_1_event_af41fa9ed45c02449030699f671331d4aa067f8b39dcd270abc715652102ce6e66}{sf::Event::GainedFocus}})}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00283}00283     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00284}00284         mHasFocus = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00285}00285     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00286}00286     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (event.\mbox{\hyperlink{classsf_1_1_event_adf2f8044f713fd9d6019077b0d1ffe0a}{type}} == \mbox{\hyperlink{classsf_1_1_event_af41fa9ed45c02449030699f671331d4aa3ce2632aef3b12bc0d22c8a3045e8eb3}{sf::Event::LostFocus}})}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00287}00287     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00288}00288         mHasFocus = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00289}00289     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00291}00291     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00292}00292 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00293}00293 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00294}00294 \textcolor{keywordtype}{void} MultiplayerGameState::updateBroadcastMessage(\mbox{\hyperlink{classsf_1_1_time}{sf::Time}} elapsedTime)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00295}00295 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00296}00296     \textcolor{keywordflow}{if} (mBroadcasts.empty())}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00297}00297         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00299}00299     \textcolor{comment}{// Update broadcast timer}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00300}00300     mBroadcastElapsedTime += elapsedTime;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00301}00301     \textcolor{keywordflow}{if} (mBroadcastElapsedTime > sf::seconds(2.5f))}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00302}00302     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00303}00303         \textcolor{comment}{// If message has expired, remove it}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00304}00304         mBroadcasts.erase(mBroadcasts.begin());}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00305}00305 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00306}00306         \textcolor{comment}{// Continue to display next broadcast message}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00307}00307         \textcolor{keywordflow}{if} (!mBroadcasts.empty())}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00308}00308         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00309}00309             mBroadcastText.\mbox{\hyperlink{classsf_1_1_text_a7d3b3359f286fd9503d1ced25b7b6c33}{setString}}(mBroadcasts.front());}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00310}00310             \mbox{\hyperlink{_week11_2_week11-_demo1-_game_over_2_include_2_utility_8hpp_add3ffea68d586813ee6765c3bc796d35}{centerOrigin}}(mBroadcastText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00311}00311             mBroadcastElapsedTime = \mbox{\hyperlink{classsf_1_1_time_aa343e67f43a940e7b3b51aa10a495f2f}{sf::Time::Zero}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00312}00312         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00313}00313     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00314}00314 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00315}00315 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00316}00316 \textcolor{keywordtype}{void} MultiplayerGameState::handlePacket(\mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} packetType, \mbox{\hyperlink{classsf_1_1_packet}{sf::Packet}}\& packet)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00317}00317 \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00318}00318     \textcolor{keywordflow}{switch} (packetType)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00319}00319     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00320}00320         \textcolor{comment}{// Send message to all clients}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00321}00321     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220a6cd0e2c2482d4841446d21650cfce562}{Server::BroadcastMessage}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00322}00322     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00323}00323         std::string message;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00324}00324         packet >> message;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00325}00325         mBroadcasts.push\_back(message);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00327}00327         \textcolor{comment}{// Just added first message, display immediately}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00328}00328         \textcolor{keywordflow}{if} (mBroadcasts.size() == 1)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00329}00329         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00330}00330             mBroadcastText.\mbox{\hyperlink{classsf_1_1_text_a7d3b3359f286fd9503d1ced25b7b6c33}{setString}}(mBroadcasts.front());}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00331}00331             \mbox{\hyperlink{_week11_2_week11-_demo1-_game_over_2_include_2_utility_8hpp_add3ffea68d586813ee6765c3bc796d35}{centerOrigin}}(mBroadcastText);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00332}00332             mBroadcastElapsedTime = \mbox{\hyperlink{classsf_1_1_time_aa343e67f43a940e7b3b51aa10a495f2f}{sf::Time::Zero}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00333}00333         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00334}00334     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00335}00335 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00336}00336     \textcolor{comment}{// Sent by the server to order to spawn player 1 airplane on connect}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00337}00337     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220a01037da7a85ce2494c247553ddebfbf7}{Server::SpawnSelf}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00338}00338     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00339}00339         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00340}00340         \mbox{\hyperlink{classsf_1_1_vector2}{sf::Vector2f}} aircraftPosition;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00341}00341         packet >> aircraftIdentifier >> aircraftPosition.\mbox{\hyperlink{classsf_1_1_vector2_a1e6ad77fa155f3753bfb92699bd28141}{x}} >> aircraftPosition.\mbox{\hyperlink{classsf_1_1_vector2_a420f2481b015f4eb929c75f2af564299}{y}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00342}00342 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00343}00343         \mbox{\hyperlink{class_aircraft}{Aircraft}}* aircraft = mWorld.\mbox{\hyperlink{class_world_a4b5a1ee9561c00df5a3348b43ed9f6d9}{addAircraft}}(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00344}00344         aircraft-\/>\mbox{\hyperlink{classsf_1_1_transformable_a4dbfb1a7c80688b0b4c477d706550208}{setPosition}}(aircraftPosition);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00346}00346         mPlayers[aircraftIdentifier].reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_player}{Player}}(\&mSocket, aircraftIdentifier, \mbox{\hyperlink{class_state_a93a72915d1aad6d8f7eacc81094dc920}{getContext}}().keys1));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00347}00347         mLocalPlayerIdentifiers.push\_back(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00349}00349         mGameStarted = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00350}00350     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00352}00352     \textcolor{comment}{// }}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00353}00353     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220a0b14dd2cfef4723b98c71a2e38473ab9}{Server::PlayerConnect}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00354}00354     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00355}00355         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00356}00356         \mbox{\hyperlink{classsf_1_1_vector2}{sf::Vector2f}} aircraftPosition;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00357}00357         packet >> aircraftIdentifier >> aircraftPosition.\mbox{\hyperlink{classsf_1_1_vector2_a1e6ad77fa155f3753bfb92699bd28141}{x}} >> aircraftPosition.\mbox{\hyperlink{classsf_1_1_vector2_a420f2481b015f4eb929c75f2af564299}{y}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00358}00358 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00359}00359         \mbox{\hyperlink{class_aircraft}{Aircraft}}* aircraft = mWorld.\mbox{\hyperlink{class_world_a4b5a1ee9561c00df5a3348b43ed9f6d9}{addAircraft}}(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00360}00360         aircraft-\/>\mbox{\hyperlink{classsf_1_1_transformable_a4dbfb1a7c80688b0b4c477d706550208}{setPosition}}(aircraftPosition);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00362}00362         mPlayers[aircraftIdentifier].reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_player}{Player}}(\&mSocket, aircraftIdentifier, \textcolor{keyword}{nullptr}));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00363}00363     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00364}00364 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00365}00365     \textcolor{comment}{// }}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00366}00366     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220a627515caee434e5f1a8797dcf2414336}{Server::PlayerDisconnect}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00367}00367     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00368}00368         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00369}00369         packet >> aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00370}00370 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00371}00371         mWorld.\mbox{\hyperlink{class_world_a91c28f4442bd6383cfe373d60acf8207}{removeAircraft}}(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00372}00372         mPlayers.erase(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00373}00373     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00375}00375     \textcolor{comment}{// }}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00376}00376     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220a1bf0bd9c2b28f6f00fdf4c1cc7af3388}{Server::InitialState}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00377}00377     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00378}00378         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftCount;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00379}00379         \textcolor{keywordtype}{float} worldHeight, currentScroll;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00380}00380         packet >> worldHeight >> currentScroll;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00381}00381 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00382}00382         mWorld.\mbox{\hyperlink{class_world_a2e0f3b87ccc0ec679e4704b05f3cd89c}{setWorldHeight}}(worldHeight);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00383}00383         mWorld.\mbox{\hyperlink{class_world_a37e200069581c4ebdc5b4d4b2ac739fc}{setCurrentBattleFieldPosition}}(currentScroll);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00384}00384 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00385}00385         packet >> aircraftCount;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00386}00386         \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} i = 0; i < aircraftCount; ++i)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00387}00387         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00388}00388             \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00389}00389             \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} hitpoints;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00390}00390             \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} missileAmmo;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00391}00391             \mbox{\hyperlink{classsf_1_1_vector2}{sf::Vector2f}} aircraftPosition;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00392}00392             packet >> aircraftIdentifier >> aircraftPosition.\mbox{\hyperlink{classsf_1_1_vector2_a1e6ad77fa155f3753bfb92699bd28141}{x}} >> aircraftPosition.\mbox{\hyperlink{classsf_1_1_vector2_a420f2481b015f4eb929c75f2af564299}{y}} >> hitpoints >> missileAmmo;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00393}00393 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00394}00394             \mbox{\hyperlink{class_aircraft}{Aircraft}}* aircraft = mWorld.\mbox{\hyperlink{class_world_a4b5a1ee9561c00df5a3348b43ed9f6d9}{addAircraft}}(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00395}00395             aircraft-\/>\mbox{\hyperlink{classsf_1_1_transformable_a4dbfb1a7c80688b0b4c477d706550208}{setPosition}}(aircraftPosition);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00396}00396             aircraft-\/>\mbox{\hyperlink{class_entity_a8791dc8f8c8b944555d67c1aa5dc245d}{setHitpoints}}(hitpoints);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00397}00397             aircraft-\/>\mbox{\hyperlink{class_aircraft_ac57cbf96490c9ae413bf7c3027a5aedb}{setMissileAmmo}}(missileAmmo);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00398}00398 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00399}00399             mPlayers[aircraftIdentifier].reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_player}{Player}}(\&mSocket, aircraftIdentifier, \textcolor{keyword}{nullptr}));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00400}00400         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00401}00401     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00402}00402 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00403}00403     \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00404}00404     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220af39f187a4ee5bbe2060d16099a34ed11}{Server::AcceptCoopPartner}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00405}00405     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00406}00406         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00407}00407         packet >> aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00408}00408 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00409}00409         mWorld.\mbox{\hyperlink{class_world_a4b5a1ee9561c00df5a3348b43ed9f6d9}{addAircraft}}(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00410}00410         mPlayers[aircraftIdentifier].reset(\textcolor{keyword}{new} \mbox{\hyperlink{class_player}{Player}}(\&mSocket, aircraftIdentifier, \mbox{\hyperlink{class_state_a93a72915d1aad6d8f7eacc81094dc920}{getContext}}().keys2));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00411}00411         mLocalPlayerIdentifiers.push\_back(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00412}00412     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00413}00413 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00414}00414     \textcolor{comment}{// Player event (like missile fired) occurs}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00415}00415     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220adc6586044f8877151745cc07e86aaafa}{Server::PlayerEvent}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00416}00416     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00417}00417         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00418}00418         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} action;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00419}00419         packet >> aircraftIdentifier >> action;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00420}00420 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00421}00421         \textcolor{keyword}{auto} itr = mPlayers.find(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00422}00422         \textcolor{keywordflow}{if} (itr != mPlayers.end())}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00423}00423             itr-\/>second-\/>handleNetworkEvent(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_player_a2da5df212d083bbb1460237f34ab0d88}{Player::Action}}\textcolor{keyword}{>}(action), mWorld.\mbox{\hyperlink{class_world_af224b413f30c86ec99d042d0f4df56ee}{getCommandQueue}}());}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00424}00424     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00425}00425 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00426}00426     \textcolor{comment}{// Player's movement or fire keyboard state changes}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00427}00427     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220a728c998480b4325abd1de68a647efddb}{Server::PlayerRealtimeChange}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00428}00428     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00429}00429         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00430}00430         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} action;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00431}00431         \textcolor{keywordtype}{bool} actionEnabled;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00432}00432         packet >> aircraftIdentifier >> action >> actionEnabled;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00433}00433 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00434}00434         \textcolor{keyword}{auto} itr = mPlayers.find(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00435}00435         \textcolor{keywordflow}{if} (itr != mPlayers.end())}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00436}00436             itr-\/>second-\/>handleNetworkRealtimeChange(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_player_a2da5df212d083bbb1460237f34ab0d88}{Player::Action}}\textcolor{keyword}{>}(action), actionEnabled);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00437}00437     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00438}00438 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00439}00439     \textcolor{comment}{// New enemy to be created}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00440}00440     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220ac3313cf4836d35b920b827b0c853ed91}{Server::SpawnEnemy}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00441}00441     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00442}00442         \textcolor{keywordtype}{float} height;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00443}00443         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} type;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00444}00444         \textcolor{keywordtype}{float} relativeX;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00445}00445         packet >> type >> height >> relativeX;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00446}00446 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00447}00447         mWorld.addEnemy(\textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_aircraft_a7dae28542933e088032b753600046acd}{Aircraft::Type}}\textcolor{keyword}{>}(type), relativeX, height);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00448}00448         mWorld.\mbox{\hyperlink{class_world_a53947f20c6a20a877b7a119d9572f9e8}{sortEnemies}}();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00449}00449     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00450}00450 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00451}00451     \textcolor{comment}{// Mission successfully completed}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00452}00452     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220ac3149c45c0b866c1ad17a2c9cf969eaf}{Server::MissionSuccess}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00453}00453     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00454}00454         \mbox{\hyperlink{class_state_a6763de833ceb9c23df45aff163a4a1cd}{requestStackPush}}(\mbox{\hyperlink{namespace_states_a571a0dc62822f97bb9511eb013d8e1c3a8037bd601b78b84885a6e1ee1ae0cef7}{States::MissionSuccess}});}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00455}00455     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00456}00456 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00457}00457     \textcolor{comment}{// Pickup created}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00458}00458     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220a903d70ec235b5d0091e1efabc782e218}{Server::SpawnPickup}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00459}00459     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00460}00460         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} type;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00461}00461         \mbox{\hyperlink{classsf_1_1_vector2}{sf::Vector2f}} position;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00462}00462         packet >> type >> position.\mbox{\hyperlink{classsf_1_1_vector2_a1e6ad77fa155f3753bfb92699bd28141}{x}} >> position.\mbox{\hyperlink{classsf_1_1_vector2_a420f2481b015f4eb929c75f2af564299}{y}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00463}00463 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00464}00464         mWorld.\mbox{\hyperlink{class_world_a9854735a8eae90bc092844071a8272cd}{createPickup}}(position, \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{class_pickup_ad4681315b06f1fc58c8f2a17937dd88a}{Pickup::Type}}\textcolor{keyword}{>}(type));}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00465}00465     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00466}00466 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00467}00467     \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00468}00468     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespace_server_a3f01a66639d25aac95a4f661182e2220a2bc55dcb334ed968816aa4ff901e205a}{Server::UpdateClientState}}:}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00469}00469     \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00470}00470         \textcolor{keywordtype}{float} currentWorldPosition;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00471}00471         \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftCount;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00472}00472         packet >> currentWorldPosition >> aircraftCount;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00473}00473 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00474}00474         \textcolor{keywordtype}{float} currentViewPosition = mWorld.getViewBounds().\mbox{\hyperlink{classsf_1_1_rect_abd3d3a2d0ad211ef0082bd0aa1a5c0e3}{top}} + mWorld.getViewBounds().\mbox{\hyperlink{classsf_1_1_rect_a6fa0fc7de1636d78cae1a1b54eef95cd}{height}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00475}00475 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00476}00476         \textcolor{comment}{// Set the world's scroll compensation according to whether the view is behind or too advanced}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00477}00477         mWorld.\mbox{\hyperlink{class_world_a20d5fafa1df7da5bb9278ca33a1c6fdc}{setWorldScrollCompensation}}(currentViewPosition / currentWorldPosition);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00479}00479         \textcolor{keywordflow}{for} (\mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} i = 0; i < aircraftCount; ++i)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00480}00480         \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00481}00481             \mbox{\hyperlink{classsf_1_1_vector2}{sf::Vector2f}} aircraftPosition;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00482}00482             \mbox{\hyperlink{namespacesf_ac2dfd4952377a26dee4750e2e4a30a15}{sf::Int32}} aircraftIdentifier;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00483}00483             packet >> aircraftIdentifier >> aircraftPosition.\mbox{\hyperlink{classsf_1_1_vector2_a1e6ad77fa155f3753bfb92699bd28141}{x}} >> aircraftPosition.\mbox{\hyperlink{classsf_1_1_vector2_a420f2481b015f4eb929c75f2af564299}{y}};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00484}00484 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00485}00485             \mbox{\hyperlink{class_aircraft}{Aircraft}}* aircraft = mWorld.\mbox{\hyperlink{class_world_a61c420ab669d97df70d7d2b69e3ca19c}{getAircraft}}(aircraftIdentifier);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00486}00486             \textcolor{keywordtype}{bool} isLocalPlane = std::find(mLocalPlayerIdentifiers.begin(), mLocalPlayerIdentifiers.end(), aircraftIdentifier) != mLocalPlayerIdentifiers.end();}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00487}00487             \textcolor{keywordflow}{if} (aircraft \&\& !isLocalPlane)}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00488}00488             \{}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00489}00489                 \mbox{\hyperlink{classsf_1_1_vector2}{sf::Vector2f}} interpolatedPosition = aircraft-\/>\mbox{\hyperlink{classsf_1_1_transformable_aea8b18e91a7bf7be589851bb9dd11241}{getPosition}}() + (aircraftPosition -\/ aircraft-\/>\mbox{\hyperlink{classsf_1_1_transformable_aea8b18e91a7bf7be589851bb9dd11241}{getPosition}}()) * 0.1f;}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00490}00490                 aircraft-\/>\mbox{\hyperlink{classsf_1_1_transformable_a4dbfb1a7c80688b0b4c477d706550208}{setPosition}}(interpolatedPosition);}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00491}00491             \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00492}00492         \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00493}00493     \} \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00494}00494     \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00495}00495 \}}
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00496}00496 }
\DoxyCodeLine{\Hypertarget{_week14-_demo1-_player2_2_source_2_multiplayer_game_state_8cpp_source_l00497}00497 \textcolor{preprocessor}{\#pragma endregion}}

\end{DoxyCode}
